<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Niezależny Oddział Dronowy QD</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Orbitron,sans-serif}
body{
    min-height:100vh;
    background:
      linear-gradient(135deg, rgba(0,60,150,0.9), rgba(140,220,255,0.9)),
      url("https://i.imgur.com/TK9YW4Q.png") center/contain no-repeat fixed;
    color:white;
    overflow-x:hidden;
}
header{
    position:fixed;
    top:0;
    width:100%;
    height:80px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 40px;
    backdrop-filter:blur(14px);
    background:rgba(0,0,0,0.4);
    z-index:1000;
}
.logo{cursor:pointer}
.logo img{height:55px;transition:0.4s;}
.logo:hover img{transform:scale(1.15) rotate(10deg);}
.nav-center{display:flex;gap:35px;}
.nav-center a{
    color:white;
    text-decoration:none;
    position:relative;
    padding-bottom:4px;
    transition:0.3s;
}
.nav-center a::after{
    content:"";
    position:absolute;
    bottom:0;
    left:0;
    width:0;
    height:3px;
    background:linear-gradient(90deg,#00c6ff,#9adfff);
    transition:0.3s;
}
.nav-center a:hover::after{width:100%;}
.nav-center a.active::after{width:100%;}
.nav-center a.active{color:#00c6ff;font-weight:600;}
.nav-icons{display:flex;gap:20px;}
#loginStatus{padding:6px;border-radius:50%;transition:0.4s;display:flex;align-items:center;justify-content:center;cursor:pointer;}
#loginStatus.logged-out{background:rgba(255,0,0,0.2);box-shadow:0 0 30px rgba(255,0,0,1);}
#loginStatus.logged-in{background:rgba(0,255,120,0.2);box-shadow:0 0 35px rgba(0,255,120,1);}
.nav-icons img{height:42px;cursor:pointer;transition:0.3s;}
.nav-icons img:hover{transform:scale(1.2)}
#komunikator{opacity:0.5}
#komunikator.active{opacity:1}
main{padding-top:140px;padding-bottom:160px;display:flex;flex-direction:column;align-items:center;gap:30px;}
.section{display:flex;justify-content:center;margin-bottom:60px;width:100%;}
.card{
    width:440px;
    background:rgba(0,0,0,0.45);
    backdrop-filter:blur(10px);
    padding:30px;
    border-radius:18px;
    cursor:pointer;
    overflow:hidden;
    transition:0.4s;
}
.card:hover{
    transform:scale(1.03);
    box-shadow:0 0 25px rgba(0,198,255,0.5);
}
.card h2{margin-bottom:5px;}
.card p{max-height:0;opacity:0;transition:0.5s;}
.card:hover p{max-height:300px;opacity:1;}
.center-logo{display:flex;justify-content:center;margin-top:120px;}
.center-logo img{width:340px}
#toasts{position:fixed;right:20px;bottom:20px;display:flex;flex-direction:column-reverse;gap:10px;z-index:3000;}
.toast{padding:14px 22px;border-radius:12px;background:rgba(0,0,0,0.85);animation:slide 0.4s ease, fade 0.5s ease 4.5s forwards;}
@keyframes slide{from{transform:translateX(120%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes fade{to{opacity:0;transform:translateX(120%)}} 
.modal-common{
    width:380px;
    padding:40px;
    background:rgba(0,0,0,0.95);
    backdrop-filter:blur(15px);
    border-radius:20px;
    display:flex; flex-direction:column; gap:15px;
    position:relative;
}
.modal h2{text-align:center;margin-bottom:10px;color:#00c6ff;font-size:1.6rem;letter-spacing:1px;}
.modal input{
    width:100%;padding:12px;border-radius:10px;border:none;background:rgba(255,255,255,0.1);color:white;
}
.modal input::placeholder{color:rgba(255,255,255,0.6);}
.modal button{
    padding:12px;border:none;border-radius:12px;background:linear-gradient(90deg,#00c6ff,#9adfff);cursor:pointer;font-weight:600;color:#000;
    transition:0.3s;
}
.modal button:hover{transform:scale(1.05);}
.eye-container{position:relative;}
.eye-container img{
    width:24px;height:24px;
    position:absolute;right:10px;top:50%;
    transform:translateY(-50%);
    cursor:pointer;
}
.checkbox-container{display:flex;align-items:center;gap:10px;font-size:14px;cursor:pointer;color:white;}
.captcha-container{display:flex;align-items:center;gap:10px;margin-top:5px;}
.captcha-box{
    background:rgba(255,255,255,0.2);
    padding:10px;font-weight:bold;user-select:none;letter-spacing:3px;font-family:monospace;
}
.captcha-input{flex:1;padding:10px;border-radius:8px;border:none;background:rgba(255,255,255,0.1);color:white;}
.modal .closeX{
    position:absolute;
    top:15px;right:15px;
    font-size:1.4rem;
    cursor:pointer;
    color:white;
    transition:0.3s;
}
.modal .closeX:hover{color:#00c6ff;transform:scale(1.2);}
#loginModal,#logoutModal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);z-index:2000;}
@keyframes popIn{0%{transform:scale(0.6);opacity:0}100%{transform:scale(1);opacity:1}}
@keyframes popOut{0%{transform:scale(1);opacity:1}100%{transform:scale(0.6);opacity:0}}
</style>
</head>
<body>
<header>
    <div class="logo" onclick="goHome()"><img src="zdjecia/qdlogo.png"></div>
    <div class="nav-center">
        <a href="index.html">Strona Główna</a>
        <a href="ogloszenia.html">Ogłoszenia</a>
        <a href="#">Konstytucja QD</a>
    </div>
    <div class="nav-icons">
        <img src="zdjecia/komunikator.png" id="komunikator" onclick="komunikatorClick()">
        <div id="loginStatus" class="logged-out" onclick="loginClick()">
            <img src="zdjecia/zaloguj.png">
        </div>
    </div>
</header>
<main id="mainContainer">
    <div class="section">
        <div class="card">
            <h2>Najnowsze Ogłoszenie</h2>
            <p>To jest testowe ogłoszenie Niezależnego Oddziału Dronowego QD. Kliknij, aby zobaczyć pełną treść.</p>
        </div>
    </div>
</main>
<div class="center-logo">
    <img src="zdjecia/qd-logo.png">
</div>
<div id="loginModal">
    <div class="modal modal-common" id="modalLogin">
        <span class="closeX" onclick="closeLogin()">×</span>
        <h2>Logowanie do QD</h2>
        <input id="email" placeholder="Email">
        <input id="name" placeholder="Imię i nazwisko">
        <div class="eye-container">
            <input type="password" id="pass" placeholder="Hasło">
            <img src="https://cdn-icons-png.flaticon.com/512/709/709612.png" id="togglePass" title="Pokaż/Ukryj hasło">
        </div>
        <div class="checkbox-container">
            <input type="checkbox" id="rememberMe">
            <label for="rememberMe">Zapamiętaj mnie</label>
        </div>
        <div class="captcha-container">
            <div class="captcha-box" id="captchaBox"></div>
            <input type="text" class="captcha-input" id="captchaInput" placeholder="Przepisz kod">
        </div>
        <button onclick="login()">Zaloguj</button>
    </div>
</div>
<div id="logoutModal">
    <div class="modal modal-common" id="modalLogout">
        <h2>Wylogowywanie</h2>
        <p>Czy chcesz się wylogować?</p>
        <button onclick="confirmLogout()">Wyloguj</button>
        <button onclick="closeLogout()">Anuluj</button>
    </div>
</div>
<div id="toasts"></div>
<script>
let accounts=[];

fetch("auctions.json")
.then(res => res.json())
.then(data => { accounts = data.accounts; })
.catch(err => { console.error("Nie udało się wczytać kont:", err);});

let logged=false,currentUser=null;

function toast(msg){
    const t=document.createElement("div");
    t.className="toast";
    t.innerText=msg;
    document.getElementById("toasts").appendChild(t);
    setTimeout(()=>t.remove(),4500);
}

let captchaCode=generateCaptcha();

function generateCaptcha(){
    const chars="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
    let code="";
    for(let i=0;i<6;i++) code+=chars.charAt(Math.floor(Math.random()*chars.length));
    document.getElementById("captchaBox").innerText=code;
    return code;
}

document.getElementById("togglePass").addEventListener("click",()=>{
    const pass=document.getElementById("pass");
    pass.type=(pass.type==="password")?"text":"password";
});

function login(){
    const email=document.getElementById("email").value.trim();
    const name=document.getElementById("name").value.trim();
    const pass=document.getElementById("pass").value;
    const captchaInput=document.getElementById("captchaInput").value.trim();
    const remember=document.getElementById("rememberMe").checked;

    if(captchaInput!==captchaCode){
        toast("Błędny kod captcha");
        captchaCode=generateCaptcha();
        document.getElementById("captchaInput").value="";
        return;
    }

    const user=accounts.find(u=>u.email===email && u.name===name && u.password===pass);
    if(user){
        logged=true;
        currentUser=user;
        toast("Zalogowano jako "+user.name);
        if(remember) localStorage.setItem("loggedUser",JSON.stringify(user));
        else sessionStorage.setItem("loggedUser",JSON.stringify(user));
        closeLogin();
        document.getElementById("loginStatus").className="logged-in";
        document.getElementById("komunikator").classList.add("active");
    }else{
        toast("Błędne dane logowania");
        captchaCode=generateCaptcha();
        document.getElementById("captchaInput").value="";
    }
}

function openLogin(){document.getElementById("loginModal").style.display="flex";}
function closeLogin(){
    const modal=document.getElementById("modalLogin");
    modal.style.animation="popOut 0.4s ease forwards";
    setTimeout(()=>document.getElementById("loginModal").style.display="none",400);
}

function loginClick(){
    if(logged) openLogout();
    else openLogin();
}

function openLogout(){document.getElementById("logoutModal").style.display="flex";}
function closeLogout(){document.getElementById("logoutModal").style.display="none";}
function confirmLogout(){
    logged=false;
    currentUser=null;
    localStorage.removeItem("loggedUser");
    sessionStorage.removeItem("loggedUser");
    document.getElementById("loginStatus").className="logged-out";
    document.getElementById("komunikator").classList.remove("active");
    toast("Wylogowano");
    closeLogout();
}

function komunikatorClick(){
    if(!logged){
        toast("Musisz się zalogować");
        return;
    }
    location.href="./komunikator.html";
}

window.onload=()=>{
    const stored=localStorage.getItem("loggedUser") || sessionStorage.getItem("loggedUser");
    if(stored){
        logged=true;
        currentUser=JSON.parse(stored);
        document.getElementById("loginStatus").className="logged-in";
        document.getElementById("komunikator").classList.add("active");
        toast("Użytkownik zalogowany: "+currentUser.name);
    }

    const navLinks=document.querySelectorAll(".nav-center a");
    navLinks.forEach(link=>{
        if(link.getAttribute("href")===window.location.pathname.split("/").pop()){
            link.classList.add("active");
        }
    });
}

function goHome(){window.location.href="index.html";}

const cards=document.querySelectorAll(".card");
cards.forEach(card=>{
    card.addEventListener("mouseenter",()=>{
        card.style.boxShadow="0 0 25px rgba(0,198,255,0.5)";
        const p=card.querySelector("p");
        if(p) p.style.maxHeight="300px";
        if(p) p.style.opacity="1";
    });
    card.addEventListener("mouseleave",()=>{
        card.style.boxShadow="none";
        const p=card.querySelector("p");
        if(p) p.style.maxHeight="0";
        if(p) p.style.opacity="0";
    });
});
</script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>
</html>




